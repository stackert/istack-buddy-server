(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[421],{1114:function(t,e,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/app/graph-test",function(){return r(5266)}])},5266:function(t,e,r){"use strict";r.r(e),r.d(e,{default:function(){return x}});var o=r(5893),s=r(7294),a=r(1032),n=r(990),l=r(6788),i=r(18),d=r(1015),c=r(6528),h=r(8521);function x(){let[t,e]=(0,s.useState)(null),[r,x]=(0,s.useState)(!0),[u,p]=(0,s.useState)(null),[f,y]=(0,s.useState)(null),[g,m]=(0,s.useState)(null),[b,j]=(0,s.useState)(!1),v=(0,s.useRef)(null),Z="148456734";(0,s.useEffect)(()=>{(async()=>{try{x(!0),p(null);let t=await fetch("/test-data/form-json/5375703.json");if(!t.ok)throw Error("Failed to load form data: ".concat(t.statusText));let r=await t.json();e(r);let o=new h.Models.FsModelForm(r,{fieldModelVersion:"v2"});console.log("Creating visibility tree for field: ".concat(Z));let s=h.TreeUtilities.FsFieldVisibilityGraph.fromFormModel(Z,o);y(s),console.log("Raw Visibility Tree:",s),console.log("Tree keys:",Object.keys(s));let a="field".concat(Z);console.log("Tree ".concat(a," keys:"),Object.keys(s[a]||{})),console.log("Converting to D3 nodes...");let n=h.TreeUtilities.transformers.toD3HierarchyGraphNodes(s);m(n),console.log("D3 Nodes:",n),console.log("D3 Nodes structure:",JSON.stringify(n,null,2));let l=Object.keys(s[a]||{}).length;console.log("Tree has ".concat(l," nodes"));let i=w(n);console.log("D3 structure has ".concat(i," nodes"))}catch(t){console.error("Error loading form data:",t),p(t instanceof Error?t.message:"Unknown error occurred")}finally{x(!1)}})()},[]),(0,s.useEffect)(()=>{if(!g||!v.current)return;let t={top:20,right:90,bottom:30,left:90};c.Ys(v.current).selectAll("*").remove();let e=c.Ys(v.current).attr("width",800).attr("height",600).call(c.sPX().scaleExtent([.1,4]).on("zoom",t=>{e.attr("transform",t.transform)})).append("g").attr("transform","translate(".concat(t.left,",").concat(t.top,")"));e.append("defs").selectAll("marker").data(["end"]).enter().append("marker").attr("id","arrow").attr("viewBox","0 -5 10 10").attr("refX",20).attr("refY",0).attr("markerWidth",8).attr("markerHeight",8).attr("orient","auto").append("path").attr("class","arrow").attr("d","M0,-5L10,0L0,5").attr("fill","#999");let r=c.Ys("body").append("div").attr("class","tooltip").style("position","absolute").style("visibility","hidden").style("background-color","white").style("border","1px solid #ddd").style("border-radius","5px").style("padding","10px").style("box-shadow","0 2px 4px rgba(0,0,0,0.2)").style("font-size","12px").style("max-width","300px").style("color","#000").style("z-index","1000"),o=c.G_s().size([800-t.left-t.right,600-t.top-t.bottom])(c.bT9(g));console.log("Tree layout data:",o),console.log("Tree layout descendants:",o.descendants());let s=c.rRh().x(t=>t.x).y(t=>t.y);e.append("g").selectAll("path").data(o.links()).enter().append("path").attr("class","link").attr("d",s).attr("fill","none").attr("stroke","#999").attr("stroke-opacity",.8).attr("stroke-width",2).attr("marker-end","url(#arrow)");let a=e.append("g").selectAll("g").data(o.descendants()).enter().append("g").attr("transform",t=>"translate(".concat(t.x,",").concat(t.y,")"));return a.append("circle").attr("r",20).attr("fill","#69b3a2").on("mouseover",function(t,e){r.style("visibility","visible").html("<strong>".concat(e.data.name,"</strong><br/><pre>").concat(JSON.stringify(e.data.nodeContent,null,2),"</pre>")).style("left",t.pageX+10+"px").style("top",t.pageY-28+"px")}).on("mouseout",function(){r.style("visibility","hidden")}),a.append("text").attr("dy",".31em").attr("text-anchor","middle").text(t=>t.data.name).style("font-size","12px").style("fill","#ffffff").style("font-weight","500"),()=>{c.Ys("body").selectAll(".tooltip").remove()}},[g]);let w=t=>{if(!t)return 0;let e=1;return t.children&&(e+=t.children.reduce((t,e)=>t+w(e),0)),e};return r?(0,o.jsx)(a.Z,{maxWidth:"xl",children:(0,o.jsxs)(n.Z,{sx:{p:2},children:[(0,o.jsx)(l.Z,{variant:"h4",gutterBottom:!0,children:"Graph Test Page"}),(0,o.jsx)(l.Z,{children:"Loading form data..."})]})}):u?(0,o.jsx)(a.Z,{maxWidth:"xl",children:(0,o.jsxs)(n.Z,{sx:{p:2},children:[(0,o.jsx)(l.Z,{variant:"h4",gutterBottom:!0,children:"Graph Test Page"}),(0,o.jsxs)(i.Z,{severity:"error",sx:{mt:2},children:["Error: ",u]})]})}):(0,o.jsx)(a.Z,{maxWidth:"xl",children:(0,o.jsxs)(n.Z,{sx:{p:2},children:[(0,o.jsx)(l.Z,{variant:"h4",gutterBottom:!0,children:"Graph Test Page"}),(0,o.jsxs)(l.Z,{variant:"h6",gutterBottom:!0,children:["Testing Visibility Graph for Field: ",Z]}),(0,o.jsxs)(n.Z,{sx:{mb:3},children:[(0,o.jsx)(l.Z,{variant:"subtitle1",gutterBottom:!0,children:"Debug Information:"}),(0,o.jsxs)(l.Z,{variant:"body2",color:"text.secondary",children:["Form Data Loaded: ",t?"Yes":"No"]}),(0,o.jsxs)(l.Z,{variant:"body2",color:"text.secondary",children:["Visibility Tree Created: ",f?"Yes":"No"]}),(0,o.jsxs)(l.Z,{variant:"body2",color:"text.secondary",children:["D3 Nodes Created: ",g?"Yes":"No"]}),f&&(0,o.jsxs)(l.Z,{variant:"body2",color:"text.secondary",children:["Tree Node Count:"," ",Object.keys(f["field".concat(Z)]||{}).length]}),g&&(0,o.jsxs)(l.Z,{variant:"body2",color:"text.secondary",children:["D3 Node Count: ",w(g)]})]}),(0,o.jsx)(n.Z,{sx:{mb:2},children:(0,o.jsxs)(d.Z,{variant:"outlined",onClick:()=>j(!b),sx:{mb:2},children:[b?"Hide":"Show"," Raw Data"]})}),(0,o.jsxs)(n.Z,{sx:{mb:3},children:[(0,o.jsx)(l.Z,{variant:"h6",gutterBottom:!0,children:"D3 Graph Visualization:"}),(0,o.jsx)(n.Z,{sx:{border:1,borderColor:"divider",borderRadius:1,bgcolor:"background.paper",overflow:"hidden"},children:(0,o.jsx)("svg",{ref:v})})]}),b&&f&&(0,o.jsxs)(n.Z,{sx:{mt:3},children:[(0,o.jsx)(l.Z,{variant:"h6",gutterBottom:!0,children:"Raw Visibility Tree Data:"}),(0,o.jsx)(n.Z,{sx:{p:2,bgcolor:"grey.100",borderRadius:1,maxHeight:"400px",overflow:"auto",fontFamily:"monospace",fontSize:"0.875rem"},children:(0,o.jsx)("pre",{children:JSON.stringify(f,null,2)})})]}),b&&g&&(0,o.jsxs)(n.Z,{sx:{mt:3},children:[(0,o.jsx)(l.Z,{variant:"h6",gutterBottom:!0,children:"D3 Nodes Data:"}),(0,o.jsx)(n.Z,{sx:{p:2,bgcolor:"grey.100",borderRadius:1,maxHeight:"400px",overflow:"auto",fontFamily:"monospace",fontSize:"0.875rem"},children:(0,o.jsx)("pre",{children:JSON.stringify(g,null,2)})})]})]})})}}},function(t){t.O(0,[18,38,888,774,179],function(){return t(t.s=1114)}),_N_E=t.O()}]);